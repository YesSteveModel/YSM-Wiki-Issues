---
title: 添加音频
createTime: 2025/01/28 16:57:54
permalink: /wiki/sound/
icon: lets-icons:sound
---

2.3.0 版本起，Yes Steve Model 模组支持在动画里调用音频了，但是有一些注意事项：

- 音频文件可以内置于模型包内，也支持调用原版游戏的音频
- 默认情况下，内置的音频需要放置在目录下的 sounds 文件夹里
- 需要使用新版的文件结构才能使用音频，旧版结构无法使用
- 音频必须为 ogg 格式。建议使用单声道，这样游戏内才能听到立体声效果。
- 单个音频不允许超过 4M，整个模型文件不允许超过 66M

::: tip 我该如何转换音频？

音频转换的工具很多，常用的有格式工厂和 Adobe Audition。格式工厂简单易用，方便新手使用。

格式工厂下载：[官网](http://www.pcfreetime.com/formatfactory/CN/index.html) [腾讯软件中心](https://pc.qq.com/detail/11/detail_1511.html)

Adobe Audition 是专业音频制作软件，上手有门槛，但是功能更为强大！

当然，您也可以使用其他转换工具，例如：Audacity、FFmpeg 等，只要能转换为 ogg 格式即可。

:::

## 添加步骤

:::: steps

1. 新建音频文件夹

    文件夹名为固定名称：`sounds`

    ![1.png](https://s2.loli.net/2025/01/30/HZMXbJgK1i6raef.png)

2. 添加 .ogg 文件

    仅能使用 ogg 格式，其他格式（wav 或者 mp3 等需要转换）

    ![4.png](https://s2.loli.net/2025/01/30/niRbwcJYmG9dqzO.png)

3. 在 BlockBench 内为动画添加音频

    ![3.png](https://s2.loli.net/2025/01/30/bQ3r4OSskhH5z7a.png)

::::

## 音频名如何书写？

### 内置音频

如果你的音频路径是 `sounds/啊哈哈哈.ogg`，那么你只需要在基岩版动画的音频关键帧里填写 `啊哈哈哈` 即可，不需要加 sounds 前缀和
ogg 后缀。

::: tip 我想换个文件夹放音频，能自定义么？

可以，首先你需要给你的 `ysm.json` 的 `files` 字段中新增 `sound_path` 字段，填写你想放置音频的文件夹路径。

写法参考如下：

```jsonc {5}
{
    "files": {
        // 支持任意字符
        // 后续基岩版动画里音频关键帧填写的名称和上述一致，不需要添加此文件夹前缀和 ogg 后缀
        "sound_path": "声音文件夹"
    }
}
```

:::

### 原版游戏音频

如果你在基岩版动画的音频关键帧里填写的是原版音频的 ID（类似于：`minecraft:block.anvil.hit`），那么会调用原版音频进行播放。

原版资源包也可以添加额外的音频文件，并且支持音频随机播放和权重设置，详情可查看官方相关教程：

- 资源包制作教程：[Minecraft Wiki](https://zh.minecraft.wiki/w/Tutorial:%E5%88%B6%E4%BD%9C%E8%B5%84%E6%BA%90%E5%8C%85?variant=zh-cn)
- 音效和音乐包教程：[Minecraft Wiki](https://zh.minecraft.wiki/w/Tutorial:%E5%88%B6%E4%BD%9C%E8%B5%84%E6%BA%90%E5%8C%85/%E9%9F%B3%E6%95%88%E5%92%8C%E9%9F%B3%E4%B9%90)

::: tip

我们强烈建议您使用原版资源包来添加音频，这样可以减少模型文件的大小，还能避免在某些情况下可能出现的版权问题。

:::

## 2.5.3 版本音频系统更新

### 动画控制器音效
blockbench 内制作动画控制器时附加的音效现在已支持，在进入该状态并执行完“进入时”molang 后播放
![pZaUiDA.webp](https://s41.ax1x.com/2026/01/04/pZaUiDA.webp)

### 播放上下文
#### 划分方式
播放进程根据上下文的不同分为三种：

+ 动画上下文

使用动画内的音效帧、指令关键帧 molang 和脚本控制器 molang 播放音频（即创建播放进程）属于该上下文。在动画结束或进入下一轮循环时自动停止。
![pZaUFHI.webp](https://s41.ax1x.com/2026/01/04/pZaUFHI.webp)

+ 动画控制器上下文

使用动画控制器添加的音效，以及在“进入时”和“退出时”molang 创建的播放进程属于该上下文。在当前动画控制器切换到其他状态时自动停止。

+ 全局上下文

使用轮盘 molang、mc 指令执行 molang 和其他 molang 事件内创建的播放进程属于该上下文，不会自动停止。

此外，在切换模型、实体被移除、传送到其他维度时会强制停止所有的播放进程。

注意：

+ 脚本控制器内要在 set_animation 或 reset 之后创建播放进程，否则会立刻被重置；
+ 使用`ysm.sync`触发`sync`事件创建的播放进程属于全局上下文，而不是`ysm.sync`所在的上下文。

#### 主动停止
播放进程除了播放完毕后停止、上下文自动停止以外，还可使用 molang`ysm.stop_sound`和`ysm.stop_all_sounds`主动停止。在新版本加入了“上下文”的概念后，这种方法默认只能停止当前上下文的播放进程，对其他上下文无效。

此外，`ysm.stop_all_sounds`在过去版本仅停止由 molang 创建的播放进程，在新版本下还会停止由动画音效帧和动画控制器音效创建的播放进程。

### molang 改动
旧版本音频相关的 molang 函数如图，这三个函数的用法在新版本都有扩展
![pZaUAEt.webp](https://s41.ax1x.com/2026/01/04/pZaUAEt.webp)

#### 停止
`ysm.stop_sound`和`ysm.stop_all_sounds`添加了一个可选参数`global`：该参数为 1 时，会停止全局上下文的播放进程；若为 0 或未指定，则停止当前上下文的播放进程。

如：

```c
ysm.stop_sound('fx', 1)
```

```c
ysm.stop_all_sounds(0)
```

```c
ysm.stop_all_sounds
```

#### 播放类型
如上图，`ysm.play_sound`的`boolean` 参数在过去的作用仅仅为“强制播放”，取值为 0 或 1。新版本该参数还可指定上下文和循环类型：

+ 若要在忽略当前上下文，指定在全局上下文内创建播放进程，则在“强制播放”参数的基础上加 2；
+ 若要指定循环播放，则在以上的基础上加 4。

如：

```c
ysm.play_sound('fx', 'sample', 1)
```

```c
ysm.play_sound('fx', 'sample', 3)
```

```c
ysm.play_sound('fx', 'sample', 7)
```

```c
ysm.play_sound('fx', 'sample', 4)
```

#### 音频 id
`ysm.play_sound`的`id`参数在过去版本只能为字符串类型，当前版本还可以为不小于 0 的数值，如：

```c
ysm.play_sound(1, 'sample')	// 创建播放进程并命名为 1
ysm.stop_sound(1)	// 停止名称为 1 的播放进程
```

#### 匿名播放进程
在过去版本使用`ysm.play_sound`时若存在相同`id`的播放进程，如果指定了“强制播放”会停止旧的播放进程并创建新的，如果未指定则忽略本次播放操作。

新版本加入了“匿名播放进程”的概念：当`id`参数为 0 时，会忽略同名的播放进程并创建新的播放进程，可实现若干个同名播放进程同时存在的效果（此时“强制播放”无效）。

注意：

+ 匿名播放进程仍然受“播放上下文”影响；
+ `ysm.stop_sound`无法停止匿名播放进程；
+ `ysm.stop_all_sounds`会停止所有匿名播放进程；
+ 动画音效帧、动画控制器音效创建的都是匿名播放进程。

### opus 音频
新版本改进了 opus 解码器以获得更好的播放效果。

opus 音频编码相比目前广泛使用的 vorbis 有更高的压缩质量，相同体积可以有更高的音质。您可以在这里下载适用于 YSM 的高质量 opus 编码工具。

<FileCard
fileName="ysm_sound_converter_v1.1.zip"
fileSize="2.11 MB"
fileUrl="/files/ysm_sound_converter_v1.1.zip"
/>

