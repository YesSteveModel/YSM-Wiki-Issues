---
title: 沉浸式奏乐动画
createTime: 2026/01/04 23:36:29
permalink: /wiki/animation/immersive-melodies/
icon: mingcute:music-line
---

`2.6.0` 起，YSM 对沉浸式奏乐（Immersive Melodies）做了更深度的联动，模型可以根据演奏数据驱动更生动的乐器动作。

## 添加定位文件

默认模型的沉浸式奏乐动画全部放置于 `im.animation.json`文件中，本质为手部条件动画。会在玩家手持对应物品，进行相关操作时播放。

如果需要修改默认路径，则需要去你的 `ysm.json` 的 `animation` 字段里添加一个新的字段 `immersive_melodies` 如下图所示：

```jsonc title="ysm.json"
"animation": {
    "main": "animations/main.animation.json",
    //...
    //这里填你的路径
    "immersive_melodies": "animations/im.animation.json"
}
```

动画清单较多，这里不逐个列出。请以默认模型的 `im.animation.json` 为准。

这里仅仅提供乐器名与英文 id 的对照。

|  乐器   |    英文 id     |
|:-----:|:------------:|
|  风笛   |  `bagpipe`   |
| 迪吉里杜管 | `didgeridoo` |
|  长笛   |   `flute`    |
|  琉特琴  |    `lute`    |
|  钢琴   |   `piano`    |
|  三角铁  |  `triangle`  |
|  小号   |  `trumpet`   |
|  小鼓   | `tiny_drum`  |
|  提琴   |   `vielle`   |
| 末影贝斯  | `ender_bass` |
|  手碟   |  `handpan`   |

## Molang 变量

以下变量可用于驱动动画细节（如手指力度、摆动幅度、呼吸节奏等）：

|      Molang       |              含义               |
|:-----------------:|:-----------------------------:|
| `ctrl.im_current` |        当前电平强度，范围 `0~1`        |
|  `ctrl.im_delta`  |     距离上一次音符输出的时间间隔（单位：ms）     |
|  `ctrl.im_pitch`  | 音高，常见范围 `0~2`（具体取值由正在弹奏的音符决定） |
| `ctrl.im_volume`  |      音符强度（力度），常见范围 `0~2`      |
|  `ctrl.im_time`   |     从开始演奏到当前的累计时间（单位：ms）      |
